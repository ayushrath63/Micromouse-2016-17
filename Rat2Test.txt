#include "mbed.h"
void forward(float duration, double speed); //duration in second, speed in percentage 1 = 100%
void backward(float duration, double speed);
void turnLeft(float duration, double speed);
void turnRight(float duration, double speed);
void brake();
 
// declaring motors as pwm
PwmOut MRF(PA_7); //Motor: Right-Forward
PwmOut MRB(PB_6); //Motor: Right-Backward
PwmOut MLF(PB_10);
PwmOut MLB(PC_7);
Timer t;


int main() 
{
    forward(4,10); //3 second and 20% speed
    brake();
    turnRight(.4,20);
    brake();
    forward(1,10);
    brake();
    turnLeft(.4,20);
    brake();
    forward(1,10);
    brake();
    turnRight(.8,20);
    brake();
    
    
}
 
void forward(float duration, double speed)
{
    t.reset();
    t.start();
    speed = 0.01 * speed;
 //   MRF.period(0.1f); 
 //   MLF.period(0.1f); 
    MRF = speed; MLF = speed; //set speed
    while (t.read() < duration);
    MRF = 0; MLF = 0; //set speed back to 0   
}
 
void turnRight(float duration, double speed)
{
    t.reset();
    t.start();
    speed = 0.01 * speed;
 //   MRB.period(0.1f); 
 //   MLF.period(0.1f); 
    MRB = speed; MLF = speed; //set speed
    while (t.read() < duration);
    MRB = 0; MLF = 0; //set speed back to 0   
}
 
void turnLeft(float duration, double speed)
{
    t.reset();
    t.start();
    speed = 0.01 * speed;
 //   MRF.period(0.1f); 
 //   MLB.period(0.1f); 
    MRF = speed; MLB = speed; //set speed
    while (t.read() < duration);
    MRF = 0; MLB = 0; //set speed back to 0   
}

void backward(float duration, double speed)
{
    t.reset();
    t.start();
    speed = 0.01 * speed;
 //   MRB.period(0.1f); 
 //   MLB.period(0.1f); 
    MRB = speed; MLB = speed; //set speed
    while (t.read() < duration);
    MRB = 0; MLB = 0; //set speed back to 0   
}

void brake()
{
    MRF = 1; MLF = 1; MRB = 1; MLB = 1;
    wait_ms(250);
    MRF = 0; MLF = 0; MRB = 0; MLB = 0;
}


